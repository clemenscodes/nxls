(()=>{var e,t,n=[,e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=1,e.exports=t},e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=2,e.exports=t},e=>{function t(e){return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}))}t.keys=()=>[],t.resolve=t,t.id=3,e.exports=t},e=>{"use strict";e.exports=require("nx/src/native")}],o={};function r(e){var t=o[e];if(void 0!==t)return t.exports;var s=o[e]={exports:{}};return n[e](s,s.exports,r),s.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,r.t=function(n,o){if(1&o&&(n=this(n)),8&o)return n;if("object"==typeof n&&n){if(4&o&&n.__esModule)return n;if(16&o&&"function"==typeof n.then)return n}var s=Object.create(null);r.r(s);var a={};e=e||[null,t({}),t([]),t(t)];for(var i=2&o&&n;"object"==typeof i&&!~e.indexOf(i);i=t(i))Object.getOwnPropertyNames(i).forEach((e=>a[e]=()=>n[e]));return a.default=()=>n,r.d(s,a),s},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};(()=>{"use strict";r.r(s);require("core-js/modules/es.promise.js"),require("core-js/modules/es.regexp.to-string.js"),require("core-js/modules/es.string.ends-with.js"),require("core-js/modules/es.array.iterator.js"),require("core-js/modules/web.dom-collections.iterator.js");let e;const t={log(t,...n){null==e||e(`[Nxls] - ${new Date(Date.now()).toISOString()} - ${t}\n`,...n)}},n=require("vscode-json-languageservice");let o;function a(){return o||t.log("Language service not configured"),o}const i=require("request-light"),c=require("vscode-uri"),l=require("fs");function u(e=["https","http","file"]){const t={};for(const n of e)"file"===n?t[n]={getContent:(e,t)=>new Promise(((n,o)=>{const r=c.URI.parse(e);l.readFile(r.fsPath,t,((e,t)=>{if(e)return o(e);n(t.toString())}))}))}:"http"!==n&&"https"!==n||(t[n]={getContent:(e,t)=>(0,i.xhr)({url:e,followRedirects:5,headers:{"Accept-Encoding":"gzip, deflate"}}).then((e=>e.responseText),(e=>Promise.reject(e.responseText||(0,i.getErrorStatusDescription)(e.status)||e.toString())))});return e=>{const n=e.substr(0,e.indexOf(":")),o=t[n];return o?o.getContent(e):Promise.reject("Unable to retrieve schema")}}require("core-js/modules/es.array.sort.js"),require("core-js/modules/es.object.from-entries.js"),require("core-js/modules/es.regexp.constructor.js"),require("core-js/modules/es.regexp.exec.js"),require("core-js/modules/es.string.replace.js");function p(e){const t=Object.entries(e.projects||{}).sort(((e,t)=>e[0].localeCompare(t[0])));return e.projects=Object.fromEntries(t),e}function f(e,t){return t in e}function d(e,t){if(t instanceof Error){const n=t;return`${e}: ${n.message}\n${n.stack}`}return"string"==typeof t?`${e}: ${t}`:t?`${e}: ${t.toString()}`:e}const m=require("path"),g=require("fs/promises");async function h(e){try{return(await(0,g.stat)(e)).isFile()}catch(t){return!1}}require("core-js/modules/es.string.starts-with.js");const y=require("@yarnpkg/fslib"),j=require("@yarnpkg/libzip"),w=require("jsonc-parser"),v=new j.ZipOpenFS({libzip:j.getLibzipSync}),x=new y.PosixFS(v),b={};function k(e,t=""){const n=m.join(t,e);return delete b[n]}async function O(e,t=""){if(!e)return{path:"",json:{}};let n=m.join(t,e);n.startsWith("file:\\")&&(n=n.replace("file:\\",""));try{const e=await x.statPromise(n);var o;if(b[n]||e.isFile())return b[o=n]||(b[o]=await async function(e){const t=await x.readFilePromise(e,"utf8");try{return JSON.parse(t)}catch(n){const e=[],o=(0,w.parse)(t,e);if(e.length>0)for(const{error:t,offset:r}of e);return o}}(n)),{path:n,json:b[n]}}catch(r){}return{path:n,json:{}}}async function P(e){try{return(await(0,g.stat)(e)).isDirectory()}catch(t){return!1}}async function N(e){const{json:t}=await O((0,m.join)(e,"package.json"));return{packagePath:e,packageName:t.name,packageJson:t}}require("core-js/modules/es.array.includes.js"),require("core-js/modules/es.string.includes.js");let R;async function q(e){const t=[".cjs",".js"];for(const o of t)try{const t=`.pnp${o}`,n=(0,m.join)(e,t);if(await h(n))return n}catch(n){return}}async function $(e){const t=await q(e);if(t){if(!R){const e=r(1)(t);e.setup(),R=e}return R}}async function D(e){try{return!!(await q(e))}catch(t){return!1}}async function T(e,t){try{var n;const r=await $(e);if(!r)return;let s=null!=(n=r.resolveToUnqualified(t,e+"/"))?n:"";var o;if(s.includes("__virtual__"))s=null!=(o=null==r.resolveVirtual?void 0:r.resolveVirtual(s))?o:"";return s}catch(r){return}}async function C(e,t,n){const o=[];return o.push(...await async function(e,t,n){if(!n)return[];if(t.major<13)return[];const o=Object.values(n).map((t=>`${e}/${t.root}/package.json`)),r=[];for(const a of o)try{(await(0,g.stat)(a)).isFile()&&r.push(a.replace("/package.json",""))}catch(s){}return r}(e,t,n)),await D(e)&&o.push(...await async function(e){const t=await $(e);if(!t)return[];t.resolveRequest;const n=[];for(const r of t.getDependencyTreeRoots()){const s=t.getPackageInformation(r);if(null!=s&&s.packageDependencies)for(const[t,r]of null!=(o=null==s?void 0:s.packageDependencies)?o:{}){var o;if(null===r)continue;if(!Array.isArray(r)&&r.startsWith("workspace:"))continue;const s=await T(e,t);s&&n.push(s)}}return n}(e)),o.push(...await async function(e){const t=(0,m.join)(e,"node_modules"),n=(0,m.join)(e,".nx","installation","node_modules");let o=t;const r=[];try{if(!(await(0,g.stat)(t)).isDirectory())return r}catch(a){try{if(!(await(0,g.stat)(n)).isDirectory())return r;o=n}catch(i){return r}}const s=await(0,g.readdir)(o);for(const l of s)try{if(l.startsWith("."))continue;if(!(await(0,g.stat)((0,m.join)(o,l))).isDirectory())continue;l.startsWith("@")?(await(0,g.readdir)((0,m.join)(o,l))).forEach((e=>{r.push(`${o}/${l}/${e}`)})):r.push(`${o}/${l}`)}catch(c){continue}return r}(e)),o}async function E(e,t){if(t.startsWith("."))return(0,m.join)(e,t);if(await D(e))return T(e,t);const n=(0,m.join)(e,"node_modules",t),o=(0,m.join)(e,".nx","installation","node_modules",t);try{return await P(n)?n:await P(o)?o:void 0}catch(r){return}}async function A(e,t){const n=e=>(0,m.join)(e,t),o=await E(e,"nx");if(o){const e=n(o);if(await h(e))return e}const r=await E(e,"@nrwl/workspace");if(r){const e=n(r);if(await h(e))return e}}const S=require("semver");const F=require("nx/src/devkit-exports"),M=require("os");function U(e){let t=e.displayCommand;if(e.encapsulatedNx)t="win32"==(0,M.platform)()?t.replace(/^nx/,"./nx.bat"):t.replace(/^nx/,"./nx");else{const n=(0,F.detectPackageManager)(e.cwd),o=(0,F.getPackageManagerCommand)(n);t="yarn"===n?`${o.exec} --silent ${t}`:`${o.exec} ${t}`}return t}const W=require("rxjs");require("core-js/modules/es.object.assign.js"),require("core-js/modules/es.string.match.js");async function _(e,t){return G(await A(e,(0,m.join)("src","daemon","client","client.js")),t)}async function I(e,t){const n=await A(e,(0,m.join)("src","utils","output.js"));if(n)return G(n,t)}async function V(e,t){const n=await A(e,(0,m.join)("src","project-graph","file-map-utils.js"));if(n)return G(n,t)}async function L(e,t){let n=await A(e,(0,m.join)("src","project-graph","project-graph.js"));return n||(n=await A(e,(0,m.join)("src","core","project-graph","project-graph.js"))),G(n,t)}async function z(e,t){let n=await A(e,(0,m.join)("src","project-graph","file-utils.js"));return n||(n=await A(e,(0,m.join)("src","core","file-utils.js"))),G(n,t)}async function G(e,t){if(!e)throw null==t||t.log(`Unable to load the ${e} dependency from the workspace. Please ensure that the proper dependencies are installed locally.`),"local Nx dependency not found";"win32"===(0,M.platform)()&&(e=e.replace(/\\/g,"/"));const n=r(2)(e);return null==t||t.log(`Using local Nx package at ${e}`),n}const H=require("perf_hooks");async function J(e,n,o){let r,s,a=null;const i=H.performance.now();if(o.log("Retrieving workspace configuration"),n.major<12)return t.log("Major version is less than 12"),K(e);try{process.env.CI=!1,process.env.NX_PROJECT_GLOB_CACHE=!1,process.env.NX_WORKSPACE_ROOT_PATH=e;const[d,m,g,h,y]=await Promise.all([z(e,o),L(e,o),I(e,o),V(e,o),_(e,o)]);let j;if(!(0,S.gte)(n.full,"17.3.0"))try{j=d.readWorkspaceConfig({format:"nx",path:e})}catch(f){o.log("Unable to read workspace config from nx workspace package"),j=(await K(e)).workspaceConfiguration,s=`${f.stack}`}try{if(process.exit=function(e){console.warn("process.exit called with code",e)},void 0!==g&&(g.output.error=e=>{}),n.major<13)a=m.createProjectGraph();else if((0,S.gte)(n.full,"17.2.0")){t.log("createProjectGraphAndSourceMapsAsync");const e=await m.createProjectGraphAndSourceMapsAsync({exitOnError:!1});a=e.projectGraph,r=e.sourceMaps,t.log("createProjectGraphAndSourceMapsAsync successful")}else t.log("createProjectGraphAsync"),a=await m.createProjectGraphAsync({exitOnError:!1}),t.log("createProjectGraphAsync successful")}catch(f){t.log("Unable to get project graph"),t.log(f.stack),s=`${f.stack}`}let w={};var c,l,u,p;if((0,S.gte)(n.full,"16.3.1")&&a)w=null!=(c=await(null==h?void 0:h.createProjectFileMapUsingProjectGraph(a)))?c:{};else Object.keys(null!=(l=null==(u=a)?void 0:u.nodes)?l:{}).forEach((e=>{var t,n;w[e]=null!=(t=(null==(n=a)?void 0:n.nodes[e].data).files)?t:[]}));if(j||(j={version:1,projects:{}}),j=function(e,t,n,o){if(!t)return e;const r=Object.assign({},e,{projects:{}});for(const[c,l]of Object.entries(t.nodes)){const t=null==e?void 0:e.projects[c];if(t){var s;r.projects[c]=Object.assign({},t,{targets:null!=(s=l.data.targets)?s:{},files:n[c],name:c})}else{var a,i;if(c.match(/:/))continue;r.projects[c]={root:l.data.root,targets:null!=(a=l.data.targets)?a:{},name:c,tags:null!=(i=l.data.tags)?i:[],files:n[c]}}}return Object.assign({},r,{sourceMaps:o})}(j,a,w,r),y)t.log("Resetting daemon client"),null==(p=y.daemonClient)||p.reset();const v=H.performance.now();return o.log(`Retrieved workspace configuration in: ${v-i} ms`),{workspaceConfiguration:j,error:s}}catch(f){t.log(`Unable to get nx workspace configuration: ${f}`);const n=await K(e);return Object.assign({},n,{error:`${f}`})}}async function K(e){var t;const n=(await O("workspace.json",e)).json,o=(await O("nx.json",e)).json;return{workspaceConfiguration:Object.assign({},n,o,{projects:Object.assign({},null!=(t=o.projects)?t:{},n.projects)}),configPath:(0,m.join)(e,"workspace.json")}}let B,Y=!1;const X=new S.SemVer("0.0.0");async function Z(e){if(!Y){const t=await A(e,"package.json");if(!t)return{major:X.major,minor:X.minor,full:X.version};B=r(2)(t),Y=!0}if(!B)return{major:X.major,minor:X.minor,full:X.version};const t=(0,S.coerce)(B.version);return t?{major:t.major,minor:t.minor,full:t.version}:{major:X.major,minor:X.minor,full:X.version}}var Q=function(e){return e[e.not_started=0]="not_started",e[e.in_progress=1]="in_progress",e[e.cached=2]="cached",e}(Q||{});let ee=new W.ReplaySubject,te=Q.not_started;async function ne(e,t={log(e){console.log(e)}},n){return n&&function(e){te=Q.not_started,ee=new W.ReplaySubject,k("workspace.json",e),k("nx.json",e)}(e),(0,W.firstValueFrom)((0,W.iif)((()=>te===Q.not_started),(0,W.of)({}).pipe((0,W.tap)((()=>{te=Q.in_progress})),(0,W.switchMap)((()=>(0,W.from)(async function(e,t){try{var n,o;const r=await Z(e),s=await J(e,r,t),a=await h((0,m.join)(e,"lerna.json"));return{validWorkspaceJson:!0,workspace:p(s.workspaceConfiguration),daemonEnabled:s.daemonEnabled,isLerna:a,isEncapsulatedNx:!!s.workspaceConfiguration.installation,workspaceLayout:{appsDir:null==(n=s.workspaceConfiguration.workspaceLayout)?void 0:n.appsDir,libsDir:null==(o=s.workspaceConfiguration.workspaceLayout)?void 0:o.libsDir},error:s.error,nxVersion:r,workspacePath:e}}catch(r){return t.log(d("Invalid workspace",r)),{validWorkspaceJson:!1,workspace:{projects:{},version:2},workspacePath:e,isEncapsulatedNx:!1,nxVersion:{major:0,minor:0,full:"0.0.0"},isLerna:!1,workspaceLayout:{appsDir:"apps",libsDir:"libs"}}}}(e,t)))),(0,W.tap)((e=>{ee.next(e),te=Q.cached}))),ee))}require("core-js/modules/es.symbol.description.js"),require("core-js/modules/es.array.flat.js"),require("core-js/modules/es.array.unscopables.flat.js");let oe=function(e){return e.Application="application",e.Library="library",e.Other="other",e}({});let re;function se(e){var t;return"project"===e.name||"projectName"===e.name||"projectName"===(null==(t=e.$default)?void 0:t.$source)||"projects"===e["x-dropdown"]}async function ae(e,t){null!=t&&t.clearPackageJsonCache&&k("package.json",e);const{workspace:{projects:n},nxVersion:o}=await ne(e),r=await C(e,o,n),s=await Promise.all(r.map((async e=>await N(e)))),a=(await Promise.all(s.map((n=>ie(e,n,t))))).flat(),i=new Map;for(const c of a)c&&(i.has(pe(c.name,c.type))||i.set(pe(c.name,c.type),c));return Array.from(i.values())}async function ie(e,{packagePath:t,packageName:n,packageJson:o},r){try{const[s,a]=await Promise.all([O(o.executors||o.builders,t),O(o.generators||o.schematics,t)]);return ce(e,n,t,s,a,r)}catch(s){return null}}async function ce(e,t,n,o,r,s){const a=new Map,i=Object.assign({},o.json.executors,o.json.builders);for(const[u,p]of Object.entries(i)){if(!ue(u,p,s.includeHidden,s.includeNgAdd))continue;const e={type:"executor",name:`${t}:${u}`,schemaPath:fe(n,o.path,p.schema),implementationPath:fe(n,o.path,p.implementation),configPath:de((0,m.resolve)(n,o.path))};a.has(pe(e.name,"executor"))||a.set(pe(e.name,"executor"),e)}const c=Object.assign({},r.json.generators,r.json.schematics);for(const[u,p]of Object.entries(c))if(ue(u,p,s.includeHidden,s.includeNgAdd))try{const e={type:"generator",name:`${t}:${u}`,schemaPath:fe(n,r.path,p.schema),configPath:de((0,m.resolve)(n,r.path)),data:le(t,u,p)};if(a.has(pe(e.name,"generator")))continue;a.set(pe(e.name,"generator"),e)}catch(l){}if(r.json.extends&&Array.isArray(r.json.extends)){const t=r.json.extends,n=(await Promise.all(t.filter((e=>"@nx/workspace"!==e&&"@nrwl/workspace"!==e)).map((async t=>{const n=await E(e,t);return n?ie(e,await N(n),s):null})))).flat().filter((e=>Boolean(e)));for(const e of n)a.has(e.name)||a.set(e.name,e)}return Array.from(a.values())}function le(e,t,n){try{var o;let r;switch(n["x-type"]){case"application":r=oe.Application;break;case"library":r=oe.Library;break;default:r=oe.Other}return{name:t,collection:e,description:n.description||"",aliases:null!=(o=n.aliases)?o:[],type:r}}catch(r){console.error(r),console.error(`Invalid package.json for schematic ${e}:${t}`)}}function ue(e,t,n=!1,o=!1){return(!t.hidden||n)&&!t.private&&!t.extends&&!t["x-deprecated"]&&("ng-add"!==e||o)}function pe(e,t){return`${e}-${t}`}function fe(e,t,n){return de((0,m.resolve)(e,(0,m.dirname)(t),n))}function de(e){return"win32"===(0,M.platform)()?`file:///${e.replace(/\\/g,"/")}`:e}async function me(e,t={includeHidden:!1,clearPackageJsonCache:!1}){return(await ae(e,{clearPackageJsonCache:t.clearPackageJsonCache,includeHidden:t.includeHidden})).filter((e=>"executor"===e.type))}async function ge(e,t){e=(e=(0,m.normalize)(e)).startsWith(m.sep)?e.substring(1):e;const n=await ye([e],t);return(null==n?void 0:n[e])||void 0}async function he(e,t){var n;if(re&&re[e])return re[e];const{workspace:o}=await ne(t),r={},s=Object.entries(o.projects);for(const[,a]of s)r[a.root]=a;return re=r,null==(n=re)?void 0:n[e]}async function ye(e,n){if(!e)return;const o=e.map((e=>(0,m.normalize)(e))).map((e=>e.startsWith(m.sep)?e.substring(1):e));n=(n=(0,m.normalize)(n)).startsWith(m.sep)?n.substring(1):n;const{workspace:r}=await ne(n),s=new Map;for(const l of o)t.log(`workspacePath: ${n}, path ${l}, relative: ${(0,m.relative)(n,l)}`),s.set(l,{relativePath:(0,m.relative)(n,l),isDirectory:await P(l)});const a=Object.entries(r.projects),i=new Map;for(const[t,l]of a){var c;if(!l.files){new Map(s).forEach(((e,o)=>{const r=je([t,l],n,o);r&&(i.set(o,r),s.delete(o))}));continue}new Map(s).forEach((({relativePath:e,isDirectory:t},o)=>{if(!t)return;const r=we(l.root,e),a=l.sourceRoot?(0,m.relative)(n,l.sourceRoot):void 0,c=a&&we(a,e);(r||c)&&(i.set(o,l),s.delete(o))}));const e=[...s.entries()].filter((([e,{isDirectory:t}])=>!t));if(null==(c=l.files)||c.forEach((({file:t})=>{for(const[n,{relativePath:o}]of e)(0,m.normalize)(t)===(0,m.normalize)(o)&&(i.set(n,l),s.delete(n))})),0===s.size)break}return Object.fromEntries(i)}function je(e,t,n){var o;if(!e)return null;let r,s;const[,a]=e,i=(0,m.join)(t,a.root||a.sourceRoot||"");i===n&&(r=e);const c=(0,m.relative)(i,n);return!c||c.startsWith("..")||(0,m.isAbsolute)(c)||(s=e),(e=null!=(o=r)?o:s)?Object.assign({name:e[0]},e[1]):null}function we(e,t){const n=e.endsWith(m.sep)?e:e+m.sep,o=t.endsWith(m.sep)?t:t+m.sep;return(0,m.normalize)(o).startsWith((0,m.normalize)(n))}require("core-js/modules/es.array.reduce.js");function ve(e){return e.reduce(((e,t)=>{const n="win32"===(0,M.platform)()?t.schemaPath:`file://${t.schemaPath}`;return e[0].push({if:{properties:{builder:{const:t.name}},required:["builder"]},then:{properties:{options:{$ref:n},configurations:{additionalProperties:{$ref:n,required:[]}}}}}),e[1].push({if:{properties:{executor:{const:t.name}},required:["executor"]},then:{properties:{options:{$ref:n},configurations:{additionalProperties:{$ref:n,required:[]}}}}}),e}),[[],[]])}const xe="x-completion-type",be="x-completion-glob";let ke=function(e){return e.file="file",e.directory="directory",e.projectTarget="projectTarget",e.projects="projects",e.targets="targets",e.targetsWithDeps="targetsWithDeps",e.tags="tags",e.inputName="inputName",e.inputNameWithDeps="inputNameWithDeps",e}({});function Oe(e){return f(e,xe)}function Pe(e){return f(e,be)}const Ne={type:"array",items:{type:"string","x-completion-type":ke.projects}},Re={type:"array",items:{type:"string","x-completion-type":ke.directory}},qe=e=>[{type:"string","x-completion-type":ke.inputNameWithDeps},{type:"object",properties:{input:{type:"string","x-completion-type":ke.inputName},projects:Te(e)}},{type:"object",properties:{fileset:{type:"string"}}},{type:"object",properties:{runtime:{type:"string"}}},{type:"object",properties:{env:{type:"string"}}}],$e=e=>({type:"object",additionalProperties:{oneOf:qe(e)}}),De={type:"array",items:{type:"string","x-completion-type":ke.tags}},Te=e=>e.major<16?{type:"string",enum:["self","dependencies"]}:{oneOf:[{type:"string","x-completion-type":ke.projects},{type:"array",items:{type:"string","x-completion-type":ke.projects}}]},Ce=(e,t)=>({additionalProperties:Object.assign({type:"object",properties:Object.assign({outputs:Re},t&&{executor:{type:"string"}},t&&{configurations:{additionalProperties:{type:"object"}}},{dependsOn:{type:"array",items:{oneOf:[{type:"string","x-completion-type":ke.targetsWithDeps},{type:"object",properties:{projects:Te(e),target:{type:"string","x-completion-type":ke.targets},params:{type:"string",enum:["ignore","forward"]}}}]}},inputs:{type:"array",items:{oneOf:qe(e)}}})},t&&{allOf:t})});function Ee(e,t={},n){const[,o]=ve(e),r=function(e,t,n){var o;const r=null!=(o=Ce(n,e).additionalProperties)?o:{},s=Object.keys(t).filter((e=>!(e.includes("@")&&e.includes("/")&&e.includes(":"))&&"nx:run-commands"!==e&&"nx:run-script"!==e&&"nx:noop"!==e)).reduce(((n,o)=>{const s=t[o];let a=r;if(null!=s&&s.executor){const t=e.find((e=>{var t;const n=e.if,o=null==n||null==(t=n.properties)?void 0:t.executor;return(null==o?void 0:o.const)===s.executor}));t&&(a={if:{properties:{executor:{type:"string"}},required:["executor"]},then:r,else:t.then})}return n[o]=a,n}),{});return{type:"object",properties:{sourceRoot:{type:"string","x-completion-type":ke.directory},implicitDependencies:Ne,tags:De,namedInputs:$e(n),targets:{type:"object",properties:s,additionalProperties:r}}}}(o,t,n);return r}function Ae(e){const t=function(e){return{type:"object",properties:{nx:{type:"object",properties:{ignore:{type:"boolean"},namedInputs:$e(e),tags:De,implicitDependencies:Ne,targets:Ce(e)}}}}}(e);return t}function Se(e,t,n){const[,o]=ve(e),r=function(e){const t=new Set;for(const o of Object.values(e))for(const e of Object.keys(null!=(n=o.targets)?n:{})){var n;t.add(e)}return Array.from(t)}(t);return Fe(o,r,n)}function Fe(e,t,n){var o;const r=null!=(o=Ce(n,e).additionalProperties)?o:{};return{type:"object",properties:{tasksRunnerOptions:{type:"object",additionalProperties:{type:"object",properties:{options:{type:"object",properties:{cacheableOperations:{type:"array",items:{type:"string","x-completion-type":ke.targets}}}}}}},targetDefaults:{type:"object",properties:t.reduce(((e,t)=>(e[t]=Object.assign({type:"object"},r),e)),{})},targetDependencyConfig:{type:"array",items:{oneOf:[{type:"string","x-completion-type":ke.targetsWithDeps},{type:"object",properties:{target:{type:"string",description:"The name of the target.","x-completion-type":ke.targets}}}]}}}}}let Me,Ue,We=[];async function _e(e,n,o){if(!e)return void t.log("No workspace path provided");Ue=await ne(e,t);const{nxVersion:r,workspace:s}=Ue;Me=await me(e);const a=function(e){const[t,n]=ve(e);return function(e,t){return{title:"JSON schema for Nx workspaces",id:"https://nx.dev",type:"object",properties:{version:{type:"number",enum:[1,2]}},allOf:[{if:{properties:{version:{const:1}},required:["version"]},then:{properties:{projects:{type:"object",additionalProperties:{type:"object",properties:{architect:{description:"Configures all the targets which define what tasks you can run against the project",additionalProperties:{type:"object",properties:{builder:{description:"The function that Nx will invoke when you run this architect",type:"string"},options:{type:"object"},configurations:{description:"provides extra sets of values that will be merged into the options map",additionalProperties:{type:"object"}}},allOf:e}}}}}}}},{if:{properties:{version:{const:2}},required:["version"]},then:{properties:{projects:{type:"object",additionalProperties:{oneOf:[{type:"string"},{type:"object",properties:{targets:{description:"Configures all the targets which define what tasks you can run against the project",additionalProperties:{type:"object",properties:{executor:{description:"The function that Nx will invoke when you run this target",type:"string"},options:{type:"object"},configurations:{description:"provides extra sets of values that will be merged into the options map",additionalProperties:{type:"object"}}},allOf:t}}}}]}}}}}]}}(t,n)}(Me),i=Ee(Me,s.targetDefaults,r),c=Ae(r),l=Se(Me,s.projects,r);We=[{uri:"nx://schemas/workspace",fileMatch:["**/workspace.json"],schema:a},{uri:"nx://schemas/project",fileMatch:["**/project.json"],schema:i},{uri:"nx://schemas/package",fileMatch:["**/package.json"],schema:c},{uri:"nx://schemas/nx",fileMatch:["**/nx.json"],schema:l}];for(const t in Ie.keys()){const n=await Ge(t,e);n&&Ie.set(t,n)}He(n,o,Le(),We)}const Ie=new Map;function Ve(e){return Ie.has(e)}function Le(){return Array.from(Ie.values())}async function ze(e,t,n,o){const r=await Ge(e,t);r&&(Ie.set(e,r),He(n,o,Le(),We))}async function Ge(e,n){var o;if(!n)return void t.log(`No workspace path provided when configuring schema for ${e}`);Ue||(Ue=await ne(n,t)),Me||(Me=await me(n));const r=await he(e,n);if(!r)return;const{nxVersion:s}=Ue,a={};return Object.entries(null!=(o=r.targets)?o:{}).forEach((([e,t])=>{var n,o;const r=null!=(n=t.executor)?n:"nx:run-commands",s=null==(o=Me)?void 0:o.find((e=>e.name===r));if(!s)return;const i="win32"===(0,M.platform)()?s.schemaPath:`file://${s.schemaPath}`;a[e]={properties:{options:{$ref:i},configurations:{additionalProperties:{$ref:i,required:[]}}}}})),{uri:`nx://schemas/project-${r.name}`,fileMatch:[(0,m.join)(n,e,"project.json")],schema:{type:"object",properties:{sourceRoot:{type:"string","x-completion-type":ke.directory},implicitDependencies:Ne,tags:De,namedInputs:$e(s),targets:{type:"object",properties:a}}}}}function He(e,t,r,s){var a,i;a={schemaRequestService:u(["file"]),workspaceContext:e,contributions:[],clientCapabilities:t},i={schemas:[...r,...s]},o=(0,n.getLanguageService)(a),o.configure(i)}function Je(e){return"property"===(null==e?void 0:e.type)}function Ke(e){return"object"===(null==e?void 0:e.type)}function Be(e){return"string"===(null==e?void 0:e.type)}function Ye(e){return"array"===(null==e?void 0:e.type)}const Xe=new Map;function Ze(e){const t=e.parent;if(Je(t)&&Be(t.keyNode)){const e=t.keyNode.value.toLowerCase();return Xe.get(e)}}function Qe(e){const t=e.parent;if(Je(t)&&Be(t.keyNode)){const e=t.keyNode.value.toLowerCase();return Xe.has(e)}return!1}function et(e,t,n,o,r,s){return{label:e=`"${e}"`,documentation:s,kind:r,insertText:e,insertTextFormat:2,textEdit:{newText:e,range:{start:o.positionAt(n.offset),end:o.positionAt(n.offset+n.length)}},detail:t}}async function tt(e,t,o,r=!1){if(!e)return[];const s=[],{workspace:a}=await ne(e);for(const c of Object.keys(null!=(i=a.namedInputs)?i:{})){var i;r&&s.push(et(`^${c}`,"",t,o,n.CompletionItemKind.Property,`Base "${c}" on this project's dependencies`)),s.push(et(c,"",t,o,n.CompletionItemKind.Property))}return s}function nt(e){if(Ke(e))for(const n of e.children){var t;if(Je(n))if(("root"===n.keyNode.value||"sourceRoot"===n.keyNode.value)&&Be(n.valueNode))return null==(t=n.valueNode)?void 0:t.value}return e.parent?nt(e.parent):""}Xe.set("jestconfig",{glob:"jest.config.@(js|ts)",completionType:ke.file}),Xe.set("index",{glob:"*.html",completionType:ke.file}),Xe.set("polyfills",{glob:"*.ts",completionType:ke.file}),Xe.set("main",{glob:"*.ts",completionType:ke.file}),Xe.set("tsconfig",{glob:"tsconfig.*.json",completionType:ke.file}),Xe.set("outputpath",{completionType:ke.directory}),Xe.set("browsertarget",{completionType:ke.projectTarget}),Xe.set("servertarget",{completionType:ke.projectTarget}),Xe.set("buildtarget",{completionType:ke.projectTarget}),Xe.set("target",{completionType:ke.projectTarget}),Xe.set("devservertarget",{completionType:ke.projectTarget});const ot=require("fast-glob");var rt=r.n(ot);async function st(e,t,o,r){const s=[];if(!e)return s;const{supportsInterpolation:a,glob:i,searchType:c}=Object.assign({supportsInterpolation:!1},r);if(!Be(t))return s;const l=nt(t),u=await rt()([e+"/**/"+i],{ignore:["**/node_modules/**"],dot:!0,onlyFiles:"file"===c,onlyDirectories:"directory"===c,objectMode:!0}),p="directory"===c?n.CompletionItemKind.Folder:n.CompletionItemKind.File;for(const n of u){if(a&&n.path.startsWith(e+"/"+l)){const r="{projectRoot}"+n.path.replace(e+"/"+l,"");s.push(et(r,n.path,t,o,p))}if(n.path.startsWith(e)){const r=n.path.replace(e+"/","");if(a){const r="{workspaceRoot}"+n.path.replace(e,"");s.push(et(r,n.path,t,o,p))}else s.push(et(r,n.path,t,o,p))}}return s}async function at(e,t,o){if(!e)return[];const r=[],{workspace:s}=await ne(e),a=new Set;for(const n of Object.values(s.projects))for(const e of null!=(i=n.tags)?i:[]){var i;a.add(e)}const c=function(e){const t=e.parent;if(!Ye(t))return new Set;return new Set(t.items.map((e=>e.value)))}(t);for(const l of a)c.has(l)||r.push(et(l,"",t,o,n.CompletionItemKind.Constant));return r}async function it(e,t,o,r=!1){if(!e)return[];const s=[],{workspace:a}=await ne(e),i=new Set;for(const n of Object.values(a.projects))for(const e of Object.keys(null!=(c=n.targets)?c:{})){var c;i.add(e)}const l=function(e){const t=e.parent;if(!Ye(t))return new Set;return new Set(t.items.map((e=>e.value)))}(t);for(const u of i)if(!l.has(u)){if(r){const e=`^${u}`;if(l.has(e))continue;s.push(et(e,"",t,o,n.CompletionItemKind.Field,`Run all dependencies that have "${u}" as a target before this one`))}s.push(et(u,"",t,o,n.CompletionItemKind.Field))}return s}async function ct(e,t,o,r,s,a){if(!e)return[];const i=r.offsetAt(a),c=o.getNodeFromOffset(i);if(!c)return[];const l=function(e,t,o,r){return async(t,s)=>{const a=!1;switch(t){case ke.file:return st(e,o,r,{glob:null!=s?s:"*.*",searchType:"file",supportsInterpolation:a});case ke.directory:return st(e,o,r,{glob:null!=s?s:"*",searchType:"directory",supportsInterpolation:a});case ke.projectTarget:return async function(e,t,o){if(!e)return[];const{workspace:r}=await ne(e),s=[],a=n.CompletionItemKind.Field;for(const[n,l]of Object.entries(r.projects))for(const[e,r]of Object.entries(null!=(i=l.targets)?i:{})){var i;const l=`${n}:${e}`;s.push(et(l,"",t,o,a));for(const e of Object.keys(null!=(c=r.configurations)?c:{})){var c;const n=`${l}:${e}`;s.push(et(n,"",t,o,a))}}return s}(e,o,r);case ke.projects:return async function(e,t,o){if(!e)return[];const{workspace:r}=await ne(e),s=[];for(const a of Object.keys(r.projects))s.push(et(a,"",t,o,n.CompletionItemKind.Struct),et(`!${a}`,"",t,o,n.CompletionItemKind.Struct,`Exclude "${a}" from this project's dependencies`));return s}(e,o,r);case ke.tags:return at(e,o,r);case ke.targets:return it(e,o,r);case ke.targetsWithDeps:return it(e,o,r,!0);case ke.inputName:return tt(e,o,r);case ke.inputNameWithDeps:return tt(e,o,r,!0);default:return[]}}}(e,0,c,r);let u=[];for(const{schema:n,node:f}of s)if(f==c&&Oe(n)){const e=n[xe];if(Pe(n)){u=await l(e,n[be]);break}u=await l(e);break}const p=Ze(c);if(p&&0===u.length&&(u=await l(p.completionType,p.glob)),Ye(c.parent)){const e=c.parent.children.map((e=>JSON.stringify(e.value)));u=u.filter((t=>!e.includes(t.label)))}return u}function lt(e){return Be(e)&&Je(e.parent)&&"executor"===e.parent.keyNode.value}const ut=require("nx/src/config/schema-utils"),pt=require("vscode-languageserver");function ft(e,t){const o=e.positionAt(t.offset),r=e.positionAt(t.offset+t.length);return n.Range.create(o,r)}const dt=require("@nx/devkit/src/executors/parse-target-string");const mt=require("vscode-languageserver-textdocument"),gt=e=>{var t;return null==(t=a())?void 0:t.parseJSONDocument(e)};let ht={};const yt=10;let jt,wt=0;function vt(){return{retrieve(e,t=!0){const n=e.version,o=e.languageId,r=ht[e.uri];if(r&&r.version===n&&r.languageId===o)return r.cTime=Date.now(),{jsonAst:r.languageModel,document:r.document};t&&(e=mt.TextDocument.create(e.uri,e.languageId,e.version,e.getText().replace(/"\$schema":\s".+",/,"")));const s=gt(e);if(!s)return{jsonAst:{root:void 0,getNodeFromOffset(){}},document:e};if(ht[e.uri]={languageModel:s,version:n,languageId:o,document:e,cTime:Date.now()},r||wt++,wt===yt){let e=Number.MAX_VALUE,t=null;for(const n in ht){const o=ht[n];o.cTime<e&&(t=n,e=o.cTime)}t&&(delete ht[t],wt--)}return{jsonAst:s,document:e}},onDocumentRemoved(e){const t=e.uri;ht[t]&&(delete ht[t],wt--)},dispose(){void 0!==jt&&(clearInterval(jt),jt=void 0,ht={},wt=0)}}}function xt(e,t){if(Je(e)&&e.valueNode&&(e=e.valueNode),Ke(e))for(const n of e.properties){if(n.keyNode.value===t)return n;if(Ke(n.valueNode)){const e=xt(n.valueNode,t);if(e)return e}}}jt=setInterval((()=>{const e=Date.now()-6e4,t=Object.keys(ht);for(const n of t){ht[n].cTime<e&&(delete ht[n],wt--)}}),6e4);const bt=new Map;async function kt(e,o){if(!Be(o))return;const r=o.value;let s,a,i;try{const e=(0,dt.parseTargetString)(r);s=e.project,a=e.target,i=e.configuration}catch(b){return}const{workspace:l}=await ne(e,t),u=l.projects[s];if(!u)return void t.log(`Could not find project ${s}`);const p=(0,m.join)(e,u.root),f=(0,m.join)(p,"project.json");if(!(await h(f)))return void t.log(`Could not find target project: ${f}`);const d=await async function(e){try{return x.readFilePromise(e,"utf8")}catch(t){return""}}(f);let g=0;var y;bt.has(f)?(g=null!=(y=bt.get(f))?y:0,bt.set(f,g+1)):bt.set(f,g);const{document:j,jsonAst:w}=vt().retrieve(n.TextDocument.create(f,"json",g,d),!1),v=function(e,t,n,o){if(!t.root)return;const r=xt(t.root,"targets");if(!r)return;const s=xt(r,n);if(!s)return;if(!o)return ft(e,s);{const t=xt(s,o);if(t)return ft(e,t)}}(j,w,a,i);return v?c.URI.from({scheme:"file",path:f,fragment:`${v.start.line+1}`}).toString():void 0}async function Ot(e,t,n){var o;const r=await(null==(o=a())?void 0:o.doHover(n,e.position,t));if(!r)return;const s=n.offsetAt(e.position),i=t.getNodeFromOffset(s);return i?(function(e){return lt(e)&&(RegExp(/@nx|@nrwl\/\w+:\w+/).test(e.value)||RegExp(/nx:\w+/).test(e.value))}(i)&&(r.contents={kind:"markdown",value:`[View executor documentation on nx.dev](${Pt(i.value)})`}),r):r}function Pt(e){const[t,n]=e.replace(/@nx|@nrwl/,"").split(":");return`https://nx.dev/packages/${t}/executors/${n}`}const Nt=require("vscode-languageserver/node"),Rt=new Nt.NotificationType("nx/changeWorkspace"),qt=new Nt.NotificationType("nx/refreshWorkspace"),$t=new Nt.NotificationType("nx/reset"),Dt=new Nt.RequestType("nx/workspace"),Tt=new Nt.RequestType("nx/workspacePath"),Ct=new Nt.RequestType("nx/generators"),Et=new Nt.RequestType("nx/generatorOptions"),At=new Nt.RequestType("nx/projectByPath"),St=new Nt.RequestType("nx/projectsByPaths"),Ft=new Nt.RequestType("nx/projectByRoot"),Mt=new Nt.RequestType("nx/generatorContextFromPath"),Ut=new Nt.RequestType("nx/generatorContextV2"),Wt=new Nt.RequestType("nx/version"),_t=new Nt.RequestType("nx/projectGraphOutput"),It=new Nt.RequestType("nx/createProjectGraph"),Vt=new Nt.RequestType("nx/projectFolderTree"),Lt=new Nt.RequestType("nx/transformedGeneratorSchema"),zt=new Nt.RequestType("nx/startupMessage"),Gt=new Nt.RequestType("nx/hasAffectedProjects"),Ht=new Nt.RequestType("nx/sourceMapFilesToProjectMap"),Jt=new Nt.RequestType("nx/targetsForConfigFile");const Kt=require("node:child_process"),Bt=require("nx/src/utils/package-manager");const Yt=require("@parcel/watcher"),Xt=require("nx/src/utils/ignore"),Zt=require("minimatch"),Qt=["**/cypress.config.{js,ts,mjs,cjs}","**/{detox.config,.detoxrc}.{json,js}","**/app.{json,config.js}","**/jest.config.{cjs,mjs,js,cts,mts,ts}","**/next.config.{js,cjs,mjs}","**/nuxt.config.{js,ts,mjs,mts,cjs,cts}","**/playwright.config.{js,ts,cjs,cts,mjs,mts}","**/remix.config.{js,cjs,mjs}","**/.storybook/main.{js,ts,mjs,mts,cjs,cts}","**/{vite,vitest}.config.{js,ts,mjs,mts,cjs,cts}","**/webpack.config.{js,ts,mjs,cjs}","**/jest.preset.js","**/tsconfig.*.json","*{.csproj,fsproj,vbproj}"];async function en(e,n){const o=await Z(e),s=function(e,t){let n;return(...o)=>{clearTimeout(n),n=setTimeout((()=>e(...o)),t)}}(n,1e3);if((0,S.gte)(o.full,"16.4.0")){const n=new((await Promise.resolve().then(r.t.bind(r,4,23))).Watcher)(e);return n.watch(((e,n)=>{e?t.log("Error watching files: "+e):n.some((e=>e.path.endsWith("project.json")||e.path.endsWith("package.json")||e.path.endsWith("nx.json")||e.path.endsWith("workspace.json")||e.path.endsWith("tsconfig.base.json")||Qt.some((t=>(0,Zt.match)([e.path],t,{dot:!0})))))&&(t.log("Project configuration changed"),s())})),()=>{t.log("Unregistering file watcher"),n.stop()}}{const n=await Yt.subscribe(e,((e,n)=>{e?t.log("Error watching files: "+e.toString()):n.some((e=>e.path.endsWith("project.json")||e.path.endsWith("package.json")||e.path.endsWith("nx.json")||e.path.endsWith("workspace.json")||e.path.endsWith("tsconfig.base.json")))&&(t.log("Project configuration changed"),s())}),function(e){const t={ignore:(0,Xt.getIgnoredGlobs)(e)};"win32"===(0,M.platform)()&&(t.backend="windows");return t}(e));return()=>{t.log("Unregistering file watcher"),n.unsubscribe()}}}function tn(e){if(e.indexOf("node_modules")>-1)return[];if(e.indexOf("dist")>-1)return[];const t=[e];try{(0,l.readdirSync)(e).forEach((n=>{const o=m.join(e,n);try{(0,l.statSync)(o).isDirectory()?(0,l.statSync)(o).isDirectory()&&t.push(...tn(o)):t.push(o)}catch(r){}}))}catch(n){}return t}async function nn(e,t){const n=(o=e,Object.keys(o.properties||{}).reduce(((e,t)=>{const n=o.properties[t],r=n.$default,s="argv"===(null==r?void 0:r.$source)?r.index:void 0,a="number"==typeof s?s:void 0,i=function(e,t){var n;return!!["path"].includes(e)||("hidden"in t?!t.hidden:null==(n=t.visible)||n)}(t,n);return i?(e.push(Object.assign({name:t,originalName:t,positional:a},n)),e):e}),[]));var o;const r=new Set(e.required||[]),s=n.map((e=>{var n;const o=e["x-prompt"],s=null==t?void 0:t[null!=(n=e.originalName)?n:e.name],a=e.$default,i=Object.assign({},e,{isRequired:sn(r,e,o,a),aliases:e.alias?[e.alias]:[]},void 0!==s&&{default:s},a&&{$default:a},e.enum&&{items:e.enum.map((e=>e.toString()))},function(e){return e.items&&{items:e.items.enum||e.items.length&&e.items}}(e));if(o&&(i.tooltip=an(o)?o.message:o,i.itemTooltips=function(e){const t={};e&&an(e)&&(e.items||[]).forEach((e=>{cn(e)&&e.label&&(t[e.value]=e.label)}));return t}(o),an(o)&&!i.items)){const e=(o.items||[]).map((e=>cn(e)?"string"==typeof e.value?e.value:JSON.stringify(e.value):e));e.length>0&&(i.items=e)}return i})),a=s.some((e=>void 0!==e["x-priority"]))?on:rn;return s.sort(a)}function on(e,t){function n(e){return e.isRequired?0:"important"===e["x-priority"]?1:e["x-deprecated"]?4:"internal"===e["x-priority"]?3:2}const o=n(e),r=n(t);return o===r?"number"==typeof e.positional&&"number"==typeof t.positional?e.positional-t.positional:"number"==typeof e.positional?-1:"number"==typeof t.positional?1:e.name.localeCompare(t.name):o-r}function rn(e,t){const n=["name","project","module","watch","style","directory","port"],o=new Set(n);return"number"==typeof e.positional&&"number"==typeof t.positional?e.positional-t.positional:"number"==typeof e.positional?-1:"number"==typeof t.positional?1:e.isRequired?t.isRequired?e.name.localeCompare(t.name):-1:t.isRequired?1:o.has(e.name)?o.has(t.name)?n.indexOf(e.name)-n.indexOf(t.name):-1:o.has(t.name)?1:e.name.localeCompare(t.name)}function sn(e,t,n,o){return e.has(t.name)||!!n&&!t.default&&!o&&"boolean"!==t.type}function an(e){return void 0!==e.message}function cn(e){return void 0!==e.value||void 0!==e.label}async function ln(e,t,n){const o=(0,m.join)("tools",t);if(await P((0,m.join)(e,o))){const r=await async function(e,t,n,o){const r=(0,m.join)(e,t),s="workspace-"+("generators"===n?"generator":"schematic"),a=(0,m.join)(r,"collection.json");if(await h(a)){const t=await O(`${r}/collection.json`);return ce(e,s,a,{path:a,json:{}},t.json,o)}return await Promise.all(tn(r).filter((e=>"schema.json"===(0,m.basename)(e))).map((async e=>{var t,n;const o=await O(e,""),r=o.json.id||o.json.$id,a=null!=(t=o.json["x-type"])?t:oe.Other;return{name:s,type:"generator",schemaPath:e,data:{name:r,collection:s,options:await nn(o.json),description:null!=(n=o.json.description)?n:"",type:a}}})))}(e,o,t,n);return r}return Promise.resolve([])}async function un(e,t,n,o){const r=await O(o),s=await async function(e){const{workspace:t}=await ne(e);let n=t.generators;if(!n)try{n=t.generators||{}}catch(r){n={}}const o=Object.keys(n).reduce(((e,t)=>{if(t.includes(":")){var o;const[r,s]=t.split(":");e[r]||(e[r]={}),e[r][s]=null==(o=n)?void 0:o[t]}else{var r,s;const o=t;e[o]||(e[o]={}),Object.keys(null!=(r=null==(s=n)?void 0:s[o])?r:{}).forEach((t=>{var r;e[o][t]=null==(r=n)?void 0:r[o][t]}))}return e}),{});return o}(e),a=s&&s[t]&&s[t][n];return await nn(r.json,a)}async function pn(e,t){let n,o,r;const{workspaceLayout:s,nxVersion:a}=await ne(t);if(e){const a=(0,m.normalize)(e),i=await ge(a,t);n=i&&i.name||void 0,o=fn(a,t),r=function(e,{appsDir:t,libsDir:n},o){let r=fn(e,o);if(!r)return;r=r.replace(/\\/g,"/").replace(/^\//,""),t&&r.startsWith(t)&&(r=r.replace(t,"").replace(/^\//,""));n&&r.startsWith(n)&&(r=r.replace(n,"").replace(/^\//,""));return r}(a,s,t)}return{project:n,directory:o,normalizedDirectory:r,nxVersion:a}}function fn(e,t){var n;let o;return(0,l.existsSync)(e)&&(o=(0,l.lstatSync)(e).isDirectory()?e:(0,m.parse)(e).dir),o=null==(n=o)?void 0:n.replace((0,m.normalize)(t),""),o}async function dn(e){const n=await async function(e){const n=await A(e,(0,m.join)("src","utils","cache-directory.js"));return(await G(n,t)).cacheDir}(e),o=(0,m.join)(n,"nx-console-project-graph"),r=`${o}/project-graph.html`;return{directory:o,relativePath:`./${(0,m.normalize)((0,m.relative)(e,r))}`,fullPath:r}}const mn=require("child_process");const gn=require("util");const hn={schemaProcessors:[(e,t,n)=>{var o,r,s,a,i,c,l;if(null==e||null==(o=e.options)||!o.find((e=>"projectNameAndRootFormat"===e.name)))return e;if("derived"===(null==(r=t.workspace.workspaceLayout)?void 0:r.projectNameAndRootFormat))return Object.assign({},e,{context:Object.assign({},e.context,{prefillValues:Object.assign({},null!=(c=null==(l=e.context)?void 0:l.prefillValues)?c:{},{projectNameAndRootFormat:"derived"})})});const u=null==(s=e.options.find((e=>"projectNameAndRootFormat"===e.name)))?void 0:s.default;return Object.assign({},e,{options:e.options.map((e=>"name"===e.name?Object.assign({},e,{"x-priority":"important","x-hint":"You can provide a nested name instead of setting the directory option, e.g. my-dir/my-app"}):"directory"===e.name?Object.assign({},e,{"x-priority":"important"}):e)),context:Object.assign({},e.context,{prefillValues:Object.assign({},null!=(a=null==(i=e.context)?void 0:i.prefillValues)?a:{},{projectNameAndRootFormat:u?`${u}`:"as-provided"})})})},function(e){var t;return Object.assign({},e,{options:(null!=(t=e.options)?t:[]).filter((e=>"internal"!==e["x-priority"]&&!e["x-deprecated"]))})},(e,t)=>{var n,o,r,s,a;if(e.context=null!=(n=e.context)?n:{},e.context.prefillValues=null!=(o=e.context.prefillValues)?o:{},t.nxVersion.major<17)if(null!=(r=e.context)&&r.project)e.context.prefillValues=Object.assign({},null!=(a=e.context.prefillValues)?a:{},{project:e.context.project,projectName:e.context.project,directory:""});else if(null!=(s=e.context)&&s.normalizedDirectory){var i;e.context.prefillValues=Object.assign({},null!=(i=e.context.prefillValues)?i:{},{directory:e.context.normalizedDirectory})}return t.nxVersion.major>=18&&(e.options.find((e=>"project"===e.name||"projectName"===e.name))?l():c()),c(),e.options.find((e=>"project"===e.name||"projectName"===e.name))&&e.options.every((e=>"nameAndDirectoryFormat"!==e.name))&&l(),e;function c(){var n,o,r,s,a;if(null!=(n=e.context)&&n.directory&&null!=(o=e.context)&&o.prefillValues)e.context.prefillValues=Object.assign({},e.context.prefillValues,{cwd:null==(a=e.context)?void 0:a.directory});else if(null!=(r=e.context)&&r.project&&null!=(s=e.context)&&s.prefillValues){const n=t.workspace.projects[e.context.project].root;e.context.prefillValues=Object.assign({},e.context.prefillValues,{cwd:n})}}function l(){var t,n;null!=(t=e.context)&&t.project&&(e.context.prefillValues=Object.assign({},null!=(n=e.context.prefillValues)?n:{},{project:e.context.project,projectName:e.context.project}))}},(e,t)=>{var n,o,r,s;if(null==e||null==(n=e.options)||!n.find((e=>"nameAndDirectoryFormat"===e.name)))return e;const a=null==(o=e.options.find((e=>"nameAndDirectoryFormat"===e.name)))?void 0:o.default;return Object.assign({},e,{options:e.options.map((e=>"name"===e.name?Object.assign({},e,{"x-priority":"important","x-hint":"You can provide a nested name instead of setting the directory option, e.g. my-dir/my-component"}):"directory"===e.name?Object.assign({},e,{"x-priority":"important"}):"project"===e.name?Object.assign({},e,{"x-priority":void 0,tooltip:"When nameAndDirectoryFormat is set to as-provided, the project option will be ignored."}):e)),context:Object.assign({},e.context,{prefillValues:Object.assign({},null!=(r=null==(s=e.context)?void 0:s.prefillValues)?r:{},{nameAndDirectoryFormat:a?`${a}`:"as-provided"})})})},(e,t)=>{var n;return Object.assign({},e,{options:(null!=(n=e.options)?n:[]).map((e=>{if(se(e)){const n=Object.keys(t.workspace.projects);e.items=n.sort()}return e}))})}],validators:[],startupMessageFactories:[async function(e,t){const n=t.workspacePath;try{await(0,gn.promisify)(mn.exec)("git diff --quiet",{cwd:n,windowsHide:!0})}catch(o){return{message:"You have uncommitted changes in your workspace. We recommend that you commit any previous changes before running a generator, so that you can easily undo changes if necessary.",type:"warning"}}},(e,t,n)=>{var o,r;if(null!=e&&null!=(o=e.options)&&o.find((e=>"projectNameAndRootFormat"===e.name))&&(null==(r=t.workspace.workspaceLayout)||!r.projectNameAndRootFormat))return{message:"Starting with Nx 16.7, Nx Console will generate projects with the exact name and directory provided. Check the output files to make sure that they were created in the correct location.",type:"warning"}},(e,t)=>{var n;if(null!=e&&null!=(n=e.options)&&n.find((e=>"nameAndDirectoryFormat"===e.name)))return{message:"Starting with Nx 17, Nx Console will generate artifacts with the exact name and directory provided. Check the output files to make sure that they were created in the correct location. You can revert to the old behavior by updating the nameAndDirectoryFormat option below.",type:"warning"}}]};async function yn(e){var t,n,o,s,a,i,c,u,p;let f;try{const t=`${e}/.nx/console/plugins.mjs`;(0,l.existsSync)(t)||(f=void 0),f=await r(3)(t).then((e=>e.default))}catch(d){f=void 0}return{schemaProcessors:[...null!=(t=hn.schemaProcessors)?t:[],...null!=(n=null==(o=f)?void 0:o.schemaProcessors)?n:[]],validators:[...null!=(s=hn.validators)?s:[],...null!=(a=null==(i=f)?void 0:i.validators)?a:[]],startupMessageFactories:[...null!=(c=hn.startupMessageFactories)?c:[],...null!=(u=null==(p=f)?void 0:p.startupMessageFactories)?u:[]]}}require("core-js/modules/es.string.trim.js");let jn;const wn=require("node:path");let vn,xn;process.on("unhandledRejection",(e=>{Pn.console.error(d("Unhandled exception",e))})),process.on("uncaughtException",(e=>{Pn.console.error(d("Unhandled exception",e))}));let bn=()=>{},kn=0;const On={resolveRelativePath:(e,t)=>{const n=t.substring(0,t.lastIndexOf("/")+1);return c.Utils.resolvePath(c.URI.parse(n),e).toString()}},Pn=(0,Nt.createConnection)(Nt.ProposedFeatures.all),Nn=new Nt.TextDocuments(n.TextDocument);Nn.listen(Pn),Pn.onInitialize((async n=>{var o;!function(t){if(e)throw"Can't set logger twice";e=t.console.log.bind(t.console)}(Pn);const{workspacePath:r}=null!=(o=n.initializationOptions)?o:{};try{var s,a;if(vn=r||(null==(s=n.workspaceFolders)||null==(s=s[0])?void 0:s.uri)||n.rootPath||c.URI.parse(null!=(a=n.rootUri)?a:"").fsPath,!vn)throw"Unable to determine workspace path";xn=n.capabilities,_e(vn,On,xn),bn=await en(vn,(async()=>{vn&&await qn(vn)}))}catch(i){t.log("Unable to get Nx info: "+i.toString())}return{capabilities:{textDocumentSync:Nt.TextDocumentSyncKind.Incremental,completionProvider:{resolveProvider:!1,triggerCharacters:['"',":"]},hoverProvider:!0,definitionProvider:!0,documentLinkProvider:{resolveProvider:!1,workDoneProgress:!1},workspace:{fileOperations:{didCreate:{filters:[{pattern:{glob:"**/project.json",matches:Nt.FileOperationPatternKind.file}}]},didDelete:{filters:[{pattern:{glob:"**/project.json",matches:Nt.FileOperationPatternKind.file}}]}}}}}})),Pn.onCompletion((async e=>{var o,r,s;if(!vn)return new Nt.ResponseError(1e3,"Unable to get Nx info: no workspace path");const i=Nn.get(e.textDocument.uri);if(!i)return null;const{jsonAst:l,document:u}=Dn(i),p=c.URI.parse(i.uri).fsPath;if(p.endsWith("project.json")){let e=(0,wn.relative)(vn,(0,wn.dirname)(p));""===e&&(e="."),e&&!Ve(e)&&await ze(e,vn,On,xn)}const f=null!=(o=await(null==(r=a())?void 0:r.doComplete(u,e.position,l)))?o:n.CompletionList.create([]),d=await(null==(s=a())?void 0:s.getMatchingSchemas(u,l));if(!d)return f;const{nxVersion:m}=await ne(vn,t),g=await ct(vn,0,l,u,d,e.position);var h,y;return h=f.items,y=g,Array.prototype.push.apply(h,y),f})),Pn.onHover((async e=>{const t=Nn.get(e.textDocument.uri);if(!t)return null;const{jsonAst:n,document:o}=Dn(t);return await Ot(e,n,o)})),Pn.onDefinition((e=>{const t=Nn.get(e.textDocument.uri);if(!t||!vn)return null;const{jsonAst:n,document:o}=Dn(t);return async function(e,t,n,o){const r=o.offsetAt(t.position),s=n.getNodeFromOffset(r);if(!s||!lt(s))return;const a=(await me(e)).find((e=>e.name===s.value));if(!a)return;const i=(0,ut.resolveImplementation)(a.implementationPath,(0,m.dirname)(a.configPath));return[pt.LocationLink.create(c.URI.file(i).toString(),{start:{line:0,character:0},end:{line:0,character:0}},{start:{line:0,character:0},end:{line:0,character:0}},{start:o.positionAt(s.offset+1),end:o.positionAt(s.offset+s.length-1)})]}(vn,e,n,o)})),Pn.onDocumentLinks((async e=>{var t;const o=Nn.get(e.textDocument.uri);if(!o)return null;const{jsonAst:r,document:s}=Dn(o),i=await(null==(t=a())?void 0:t.getMatchingSchemas(s,r));return i?async function(e,t,o,r){if(!e)return[];const s=[];if(!t.root)return[];const a=nt(t.root),i=(0,m.join)(e,a);for(const{schema:l,node:u}of r){let t;if(Oe(l))t=l[xe];else if(Qe(u)){var c;t=null==(c=Ze(u))?void 0:c.completionType}if(!t)continue;if("directory"===t)continue;const r=ft(o,u);switch(t){case"file":{if(!Be(u))continue;const t=(0,m.join)(e,u.value);if(!(await h(t)))continue;u.value===a?s.push({range:r,target:i}):s.push(n.DocumentLink.create(r,t));break}case"projectTarget":{const t=await kt(e,u);t&&s.push(n.DocumentLink.create(r,t));break}}}return s}(vn,r,s,i):void 0}));const Rn=vt();async function qn(e){const n=await $n(e);await Pn.sendNotification(qt.method),null!=n&&n.error?kn<5?(kn++,t.log(`reconfiguration failed, trying again in ${kn*kn} seconds`),new Promise((e=>setTimeout(e,1e3*kn*kn))).then((()=>qn(e)))):(t.log(`reconfiguration failed after ${kn} attempts`),kn=0):kn=0}async function $n(e){!async function(){Y=!1,B=void 0}(),re=void 0,jn=void 0;const n=await ne(e,t,!0);return await _e(e,On,xn),n}function Dn(e){return Rn.retrieve(e)}Nn.onDidClose((e=>{Rn.onDocumentRemoved(e.document)})),Nn.onDidOpen((async e=>{if(!e.document.uri.endsWith("project.json"))return;const t=await ge(c.URI.parse(e.document.uri).fsPath,vn);t&&t.name&&(Ve(t.name)||ze(t.name,vn,On,xn))})),Pn.onShutdown((()=>{bn(),Rn.dispose()})),Pn.onNotification($t,(async()=>{if(!vn)return new Nt.ResponseError(1e3,"Unable to get Nx info: no workspace path");await async function(e,t){t.log("Resetting workspace with `nx reset`");const n=(0,Bt.getPackageManagerCommand)((0,Bt.detectPackageManager)(e));return new Promise(((t,o)=>{(0,Kt.exec)(`${n.exec} nx reset`,{cwd:e},(e=>{e?o(e):t()}))})).then((()=>new Promise(((o,r)=>{t.log("Starting Nx daemon"),(0,Kt.exec)(`${n.exec} nx daemon --start`,{cwd:e},(e=>{e?r(e):o()}))}))))}(vn,t),await qn(vn)})),Pn.onRequest(Dt,(async({reset:e})=>vn?ne(vn,t,e):new Nt.ResponseError(1e3,"Unable to get Nx info: no workspace path"))),Pn.onRequest(Tt,(()=>vn)),Pn.onRequest(Ct,(async e=>vn?async function(e,t={includeHidden:!1,includeNgAdd:!1}){const n=e;let o=(await ae(e,{clearPackageJsonCache:!1,includeHidden:t.includeHidden,includeNgAdd:t.includeNgAdd})).filter((e=>"generator"===e.type));return o=[...o,...await ln(n,"schematics",t),...await ln(n,"generators",t)],o.filter((e=>"generator"===e.type))}(vn,e.options):new Nt.ResponseError(1e3,"Unable to get Nx info: no workspace path"))),Pn.onRequest(Et,(async e=>vn?un(vn,e.options.collection,e.options.name,e.options.path):new Nt.ResponseError(1e3,"Unable to get Nx info: no workspace path"))),Pn.onRequest(At,(async e=>vn?ge(e.projectPath,vn):new Nt.ResponseError(1e3,"Unable to get Nx info: no workspace path"))),Pn.onRequest(St,(async e=>vn?ye(e.paths,vn):new Nt.ResponseError(1e3,"Unable to get Nx info: no workspace path"))),Pn.onRequest(Ft,(async e=>vn?he(e.projectRoot,vn):new Nt.ResponseError(1e3,"Unable to get Nx info: no workspace path"))),Pn.onRequest(Mt,(async e=>vn?async function(e,t,n){var o;if(!t)return;const r=await ge(t,n),s=r&&r.name||void 0;let a=t.replace(n,"").replace(/\\/g,"/").replace(/^\//,"");const{workspaceLayout:i}=await ne(n),c=i.appsDir,l=i.libsDir;return c&&("application"===(null==e?void 0:e.name)||"app"===(null==e?void 0:e.name)||a.startsWith(c))&&(a=a.replace(c,"").replace(/^\//,"")),l&&("library"===(null==e?void 0:e.name)||"lib"===(null==e?void 0:e.name)||a.startsWith(l))&&(a=a.replace(l,"").replace(/^\//,"")),Object.assign({project:s,projectName:s,path:a},!(s&&null!=e&&null!=(o=e.options)&&o.some(se))&&{directory:a})}(e.generator,e.path,vn):new Nt.ResponseError(1e3,"Unable to get Nx info: no workspace path"))),Pn.onRequest(Ut,(async e=>vn?pn(e.path,vn):new Nt.ResponseError(1e3,"Unable to get Nx info: no workspace path"))),Pn.onRequest(Wt,(async()=>vn?Z(vn):new Nt.ResponseError(1e3,"Unable to get Nx info: no workspace path"))),Pn.onRequest(_t,(async()=>vn?dn(vn):new Nt.ResponseError(1e3,"Unable to get Nx info: no workspace path"))),Pn.onRequest(It,(async({showAffected:e})=>{if(!vn)return new Nt.ResponseError(1e3,"Unable to get Nx info: no workspace path");try{await async function(e,t,n={log(e){console.log(e)}}){const{isEncapsulatedNx:o}=await ne(e),r=await dn(e);return new Promise(((s,a)=>{const i=U({cwd:e,displayCommand:`nx graph ${t?"--affected":""} --file `+r.relativePath,encapsulatedNx:o});n.log(`Generating graph with command: \`${i}\``);try{(0,mn.execSync)(i,{cwd:e,windowsHide:!0,stdio:"ignore"}),s(void 0)}catch(c){a(`Unable to create project graph: ${c.output[1]||c}`)}}))}(vn,e,t)}catch(n){return t.log("Error creating project graph: "+n.toString()),n}})),Pn.onRequest(Vt,(async()=>vn?await async function(e){const{workspace:{projects:t}}=await ne(e),n=new Map,o=new Set;function r(e,t){t.children.push(e)}function s(e,t,a){if(!a&&!t&&n.has(e))return;if(a&&t&&n.has(e)){const o=n.get(e);return void n.set(e,{dir:e,projectName:t,projectConfiguration:a,children:o.children})}const i={dir:e,projectName:t,projectConfiguration:a,children:[]};n.set(e,i);const c=(0,m.parse)(e).dir;c?(n.has(c)||s(c),r(n.get(e),n.get(c))):o.add(i)}for(const[a,i]of Object.entries(t))s(i.root,a,i);if(n.has(".")){const e=n.get(".");o.forEach((t=>{var n;"."!==(null==(n=t.projectConfiguration)?void 0:n.root)&&(null==e||e.children.push(t))})),o.clear(),o.add(e)}return{serializedTreeMap:Array.from(n.entries()).map((([e,t])=>({name:e,node:t}))),roots:Array.from(o).sort(((e,t)=>e.dir.localeCompare(t.dir)))}}(vn):new Nt.ResponseError(1e3,"Unable to get Nx info: no workspace path"))),Pn.onRequest(Lt,(async e=>vn?async function(e,n){const o=await yn(e),r=await ne(e);let s=n;try{var a;return null==o||null==(a=o.schemaProcessors)||a.forEach((e=>{s=e(s,r,t)})),s}catch(i){return t.log("error while applying schema processors"+i),s}}(vn,e):new Nt.ResponseError(1e3,"Unable to get Nx info: no workspace path"))),Pn.onRequest(zt,(async e=>vn?async function(e,n){const o=await yn(e),r=await ne(e);let s;try{for(const e of null!=(a=null==o?void 0:o.startupMessageFactories)?a:[]){var a;const o=await e(n,r,t);o&&(s=o)}return s}catch(i){return t.log("error while getting startup message"+i),s}}(vn,e):new Nt.ResponseError(1e3,"Unable to get Nx info: no workspace path"))),Pn.onRequest(Gt,(async()=>vn?async function(e,t){const{isEncapsulatedNx:n}=await ne(e),o=U({cwd:e,displayCommand:"nx show projects --affected",encapsulatedNx:n});return(0,mn.execSync)(o,{cwd:e,windowsHide:!0,stdio:"pipe"}).toString().trim().length>0}(vn):new Nt.ResponseError(1e3,"Unable to get Nx info: no workspace path"))),Pn.onRequest(Ht,(async()=>vn?async function(e){var t;if(jn)return jn;const{workspace:n}=await ne(e),o={};return Object.entries(null!=(t=n.sourceMaps)?t:{}).forEach((([e,t])=>{Object.values(t).forEach((([t])=>{o[t]||(o[t]=e)}))})),jn=o,o}(vn):new Nt.ResponseError(1e3,"Unable to get Nx info: no workspace path"))),Pn.onRequest(Jt,(async e=>vn?async function(e,t,n){const{workspace:{sourceMaps:o,projects:r}}=await ne(n);(0,m.normalize)(t).includes(n)&&(t=(0,m.relative)(n,t));const s=r[e];if(!s||!o)return;const a=o[s.root],i={};return Object.entries(a).filter((([e])=>e.startsWith("targets."))).forEach((([e,[n]])=>{if(n===t){var o;const t=e.split(".")[1],n=null==(o=s.targets)?void 0:o[t];n&&(i[t]=n)}})),i}(e.projectName,e.configFilePath,vn):new Nt.ResponseError(1e3,"Unable to get Nx info: no workspace path"))),Pn.onNotification(qt,(async()=>{if(!vn)return new Nt.ResponseError(1001,"Unable to get Nx info: no workspace path");await qn(vn)})),Pn.onNotification("workspace/didCreateFiles",(async e=>{if(e.files.some((e=>e.uri.endsWith("project.json"))))return vn?void(await $n(vn)):new Nt.ResponseError(1001,"Unable to get Nx info: no workspace path")})),Pn.onNotification("workspace/didDeleteFiles",(async e=>{if(e.files.some((e=>e.uri.endsWith("project.json"))))return vn?void(await $n(vn)):new Nt.ResponseError(1001,"Unable to get Nx info: no workspace path")})),Pn.onNotification(Rt,(async e=>{vn=e,await $n(vn)})),Pn.listen()})();var a=exports;for(var i in s)a[i]=s[i];s.__esModule&&Object.defineProperty(a,"__esModule",{value:!0})})();
//# sourceMappingURL=main.js.map